# Beanstalk configuration for Docker deployment

option_settings:
  # Nginx proxy configuration
  aws:elasticbeanstalk:environment:proxy:
    ProxyServer: none

  # Health check configuration
  aws:elasticbeanstalk:application:
    Application Healthcheck URL: HTTP:8080/health

  # Environment properties
  # 아래 값들은 Elastic Beanstalk 환경 변수로 설정하거나
  # Terraform output을 사용하여 동적으로 설정해야 합니다
  aws:elasticbeanstalk:application:environment:
    PORT: "8080"
    NODE_ENV: "production"
    API_GATEWAY_URL: "PLACEHOLDER_API_GATEWAY_URL"
    COGNITO_REGION: "PLACEHOLDER_COGNITO_REGION"
    COGNITO_USER_POOL_ID: "PLACEHOLDER_COGNITO_USER_POOL_ID"
    COGNITO_CLIENT_ID: "PLACEHOLDER_COGNITO_CLIENT_ID"

  # Managed updates
  aws:elasticbeanstalk:managedactions:
    ManagedActionsEnabled: true
    PreferredStartTime: "Sun:10:00"

  aws:elasticbeanstalk:managedactions:platformupdate:
    UpdateLevel: minor
    InstanceRefreshEnabled: true

  # Notifications (optional)
  aws:elasticbeanstalk:sns:topics:
    Notification Endpoint: ""

  # Enhanced health reporting
  aws:elasticbeanstalk:healthreporting:system:
    SystemType: enhanced

  # CloudWatch logs
  aws:elasticbeanstalk:cloudwatch:logs:
    StreamLogs: true
    DeleteOnTerminate: true
    RetentionInDays: 7
